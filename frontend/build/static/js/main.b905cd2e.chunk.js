(window.webpackJsonpcdf=window.webpackJsonpcdf||[]).push([[0],{54:function(e,t,n){e.exports=n(76)},60:function(e,t,n){},65:function(e,t,n){},71:function(e,t,n){},72:function(e,t,n){},73:function(e,t,n){},74:function(e,t,n){},75:function(e,t,n){},76:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(8),o=n.n(c),i=n(6),s=n(117),u=n(113),l=n(116),f=n(107),d=n(18),p=n.n(d),b=n(25),O=n(114),m=(n(60),n(12));function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(n,!0).forEach(function(t){Object(m.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var j={passphrase:"",activeVoteChoice:-1,voterlist:[]};var E=Object(a.createContext)({state:j,dispatch:function(){return 0}}),y=E.Provider,g=E,S=function(e,t){var n=t.type,a=t.payload;switch(n){case"UPDATE_PASSPHRASE":return h({},e,{passphrase:a});case"SET_CURRENT_VOTER":return h({},e,{activeVoteChoice:a});case"RESET":return j;case"UPDATE_VOTER_LIST":return h({},e,{voterlist:a})}return e},P=j;function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(n,!0).forEach(function(t){Object(m.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var x=function(e){return k.apply(this,arguments)};function k(){return(k=Object(b.a)(p.a.mark(function e(t){var n,a,r=arguments;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:{},a=n.headers?n.headers:{},e.next=4,fetch(t,C({method:"POST"},n,{headers:C({},a,{"Content-Type":"application/json"})}));case 4:return e.abrupt("return",e.sent.json());case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}var N="http://localhost:3001",T=function(e){var t=Object(a.useContext)(g).dispatch,n=Object(a.useState)(""),c=Object(i.a)(n,2),o=c[0],s=c[1],u=Object(a.useState)(!1),l=Object(i.a)(u,2),d=l[0],m=l[1],v=Object(a.useState)(""),h=Object(i.a)(v,2),j=h[0],E=h[1],y=Object(a.useState)("/images/dummy.jpg"),S=Object(i.a)(y,2),P=S[0],w=S[1],C=Object(a.useState)(!1),k=Object(i.a)(C,2),T=k[0],D=k[1];function V(){return(V=Object(b.a)(p.a.mark(function n(){var a,r;return p.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return E(""),D(!0),n.next=4,x("".concat(N,"/passphrase"),{body:JSON.stringify({passphrase:o})});case 4:a=n.sent,D(!1),a.status,r=a.data,"ok"===a.status?(m(!0),w(r.photo),t({type:"UPDATE_PASSPHRASE",payload:o}),setTimeout(e.next,1e3)):"error"===a.status&&E(a.message);case 8:case"end":return n.stop()}},n)}))).apply(this,arguments)}return Object(a.useEffect)(function(){return e.disableNext(),function(){return e.enableNext()}},[]),r.a.createElement("div",{id:"verification"},r.a.createElement("div",{id:"user-image"},r.a.createElement("img",{src:P})),j&&r.a.createElement("div",{id:"error"},j),r.a.createElement("div",{id:"passphrase"},r.a.createElement(O.a,{id:"passphrase-field",label:"Passphrase",value:o,onChange:function(e){return s(e.target.value.toUpperCase())},margin:"normal",autoComplete:"off",disabled:d||T,variant:"filled"}),r.a.createElement(f.a,{id:"validate-button",variant:"contained",onClick:function(){return V.apply(this,arguments)},disabled:d||T,color:"primary"},T?"Please wait...":"Verify")))},D=n(106),V=n(108),R=n(109),I=n(110),_=n(111),A=n(112),J=n(115);n(65);function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}var B=function(e){var t=Object(a.useContext)(g),n=t.state,c=t.dispatch,o=Object(a.useState)(n.voterlist),s=Object(i.a)(o,2),u=s[0],l=s[1];function f(e,t){var n=u.map(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(n,!0).forEach(function(t){Object(m.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e,{checked:!1})});n[t].checked=e,l(n),c({type:"SET_CURRENT_VOTER",payload:e?t:-1})}return Object(a.useEffect)(function(){if(-1!==n.activeVoteChoice){var e=JSON.parse(JSON.stringify(u));e[n.activeVoteChoice].checked=!0,l(e)}},[]),Object(a.useEffect)(function(){l(n.voterlist)},[n.voterlist]),Object(a.useEffect)(function(){fetch("".concat(N,"/voter-list")).then(function(e){return e.json()}).then(function(e){c({type:"UPDATE_VOTER_LIST",payload:e.list})})},[]),Object(a.useEffect)(function(){-1===n.activeVoteChoice?e.disableNext():e.enableNext()},[n.activeVoteChoice]),r.a.createElement(D.a,{dense:!0,id:"voter-list"},u.map(function(e,t){return r.a.createElement(V.a,{key:t,button:!0,onClick:function(n){return f(!e.checked,t)}},r.a.createElement(R.a,null,r.a.createElement(I.a,{src:"/images/candidates/c".concat(e.image,".jpg")})),r.a.createElement(_.a,{primary:e.name}),r.a.createElement(A.a,null,r.a.createElement(J.a,{edge:"end",onChange:function(e){return f(e.target.checked,t)},checked:e.checked})))}))},L=n(46),q=n.n(L),F=n(31),H=(n(71),0),M=function(e){var t=Object(a.useState)(!1),n=Object(i.a)(t,2),c=n[0],o=n[1],s=Object(a.useState)(-1),u=Object(i.a)(s,2),l=u[0],f=u[1],d=Object(a.useState)(-1),O=Object(i.a)(d,2),m=O[0],v=O[1],h=Object(a.useContext)(g).state;return Object(a.useEffect)(function(){H=Math.floor(9e14*Math.random())+1e14,e.disableNext(),console.log(h),x("".concat(N,"/submit-vote"),{body:JSON.stringify({random:H,passphrase:h.passphrase,voter:h.voterlist[h.activeVoteChoice].name})}).then(function(e){f(e.data.sessionID),v(e.data.random)})},[]),Object(a.useEffect)(function(){c&&e.enableNext()},[c]),Object(a.useEffect)(function(){var e=setInterval(Object(b.a)(p.a.mark(function e(){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x("".concat(N,"/query-vote"),{body:JSON.stringify({random:m,sessionID:l})});case 2:"done"===e.sent.status&&o(!0);case 4:case"end":return e.stop()}},e)})),3e3);return function(){return clearInterval(e)}},[m,l]),H<=0?r.a.createElement("div",null,"Loading..."):r.a.createElement("div",{id:"validate"},r.a.createElement(F.a,{variant:"h4"},c?"Confirmed. Your vote has been recorded. Please click on Finish below":"Please confirm your vote by scanning the QR code below:"),r.a.createElement("div",{id:"qr-code",className:c?"done":""},l&&m?r.a.createElement(q.a,{size:450,value:JSON.stringify({random:m,sessionID:l})}):r.a.createElement("p",null,"Loading...")))},z=(n(72),function(e){var t=Object(a.useContext)(g).state,n=t.voterlist[t.activeVoteChoice];return Object(a.useEffect)(function(){return e.enableBack(),function(){return e.disableBack()}},[]),r.a.createElement("div",{id:"confirm"},r.a.createElement("img",{src:"/images/candidates/c".concat(n.image,".jpg"),id:"voter-final"}),r.a.createElement(F.a,{variant:"h4"},"Are you sure you want to vote ",r.a.createElement("br",null),r.a.createElement("b",null,n.name),"?"))});n(73);function G(){var e=Object(a.useContext)(g).dispatch,t=Object(a.useState)(0),n=Object(i.a)(t,2),c=n[0],o=n[1],d=Object(a.useState)(!1),p=Object(i.a)(d,2),b=p[0],O=p[1],m=Object(a.useState)(!0),v=Object(i.a)(m,2),h=v[0],j=v[1],E=["Person Verification","Voter List","Confirm Choice","Validate Choice"];function y(){3===c?(o(0),e({type:"RESET",payload:null})):o(function(e){return e+1})}function S(){O(!0)}function P(){O(!1)}function w(){j(!0)}function C(){j(!1)}return r.a.createElement("div",{id:"interface"},r.a.createElement(s.a,{activeStep:c},E.map(function(e){return r.a.createElement(u.a,{key:e},r.a.createElement(l.a,null,e))})),r.a.createElement("div",{id:"content"},function(e){switch(e){case 0:return r.a.createElement(T,{next:y,disableNext:S,enableNext:P});case 1:return r.a.createElement(B,{disableNext:S,enableNext:P});case 2:return r.a.createElement(z,{enableBack:C,disableBack:w});case 3:return r.a.createElement(M,{enableNext:P,disableNext:S})}}(c),r.a.createElement("div",{id:"navigation"},h||r.a.createElement(f.a,{variant:"contained",color:"primary",disabled:h,onClick:function(){o(function(e){return e-1})}},"Back"),b||r.a.createElement(f.a,{variant:"contained",color:"primary",disabled:b,onClick:y},c===E.length-1?"Finish":"Next"))))}n(74);function Q(){return r.a.createElement("div",{id:"not-live",style:{position:"absolute",width:"100vw",height:"100vh",top:0,left:0,display:"flex",justifyContent:"center",alignItems:"center"}},r.a.createElement("h1",null,"Voting not live yet"))}var Y=function(){var e=Object(a.useReducer)(S,P),t=Object(i.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)(),s=Object(i.a)(o,2),u=s[0],l=s[1],f=Object(a.useState)(),d=Object(i.a)(f,2),p=d[0],b=d[1];return Object(a.useEffect)(function(){fetch("".concat(N,"/get-stage")).then(function(e){return e.json()}).then(function(e){l(e.stage)}),fetch("".concat(N,"/contract-address")).then(function(e){return e.json()}).then(function(e){b(e.address)})},[]),r.a.createElement(y,{value:{state:n,dispatch:c}},"VOTING"===u?r.a.createElement(G,null):u?r.a.createElement(Q,null):"...Loading",p&&r.a.createElement("p",{id:"contract-address"},"Contract address: ",p))};n(75);o.a.render(r.a.createElement(Y,null),document.getElementById("root"))}},[[54,1,2]]]);
//# sourceMappingURL=main.b905cd2e.chunk.js.map